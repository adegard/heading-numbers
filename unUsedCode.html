<div>

</div>

<script>

/**
 * Handle regexes regex expression
 */

function makeRegex(h1,h2,h3,h4,h5,h6,inherit,delimiter,trailing,pre,post){
  var regex = "";
  var del = getDelimiter(delimiter);
  var regMap = ["","[0-9]+","[\\w\\-]","[\\w\\-]","[ivxlcd]*","[IVXLCD]*"];
  var trail = ( trailing ? del : "" );
                
  if(!inherit){
    var regex = {
      h1: (pre+regMap[h1]+trail+post).replace(/\s/g,"\\s "),
      h2: (pre+regMap[h2]+trail+post).replace(/\s/g,"\\s "),
      h3: (pre+regMap[h3]+trail+post).replace(/\s/g,"\\s "),
      h4: (pre+regMap[h4]+trail+post).replace(/\s/g,"\\s "),
      h5: (pre+regMap[h5]+trail+post).replace(/\s/g,"\\s "),
      h6: (pre+regMap[h6]+trail+post).replace(/\s/g,"\\s ")
    };
  } else {
    var regex = {
      h1 : (pre+regMap[h1]+trail+post),
      h2 : (pre+regMap[h1]+del+regMap[h2]+trail+post).replace(/\s/g,"\\s "),
      h3 : (pre+regMap[h1]+del+regMap[h2]+del+regMap[h3]+trail+post).replace(/\s/g,"\\s "),
      h4 : (pre+regMap[h1]+del+regMap[h2]+del+regMap[h3]+del+regMap[h4]+trail+post).replace(/\s/g,"\\s "),
      h5 : (pre+regMap[h1]+del+regMap[h2]+del+regMap[h3]+del+regMap[h4]+del+regMap[h5]+trail+post).replace(/\s/g,"\\s "),
      h6 : (pre+regMap[h1]+del+regMap[h2]+del+regMap[h3]+del+regMap[h4]+del+regMap[h5]+del+regMap[h6]+trail+post).replace(/\s/g,"\\s ")
    };
  }
  return regex; 
}


function setRegex(regex){
  var documentProperties = PropertiesService.getDocumentProperties();
  documentProperties.setProperties({
    'regexh1' : regex.h1,
    'regexh2' : regex.h2,
    'regexh3' : regex.h3,
    'regexh4' : regex.h4,
    'regexh5' : regex.h5,
    'regexh6' : regex.h6,
  });
}

function getRegex(eLevel){
  return getOneProperty("regexh"+eLevel);
}
</script>